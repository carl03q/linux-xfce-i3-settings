var TBPopup=(function(){var b=this;this.errorPromptCookie="errorprompt";$("input").focus(function(){Mousetrap.pause()});$("input").blur(function(){Mousetrap.unpause()});Version.onNewInstall(function(d){Popup.latestId(-1);Version.update();var c=isOpera()?"Opera":"Chrome";Analytics.send(Analytics.Install,"Tab Bundler Installed - {0}".format(c),d);$(".new-install-only").toggle();$(document).trigger("sign-up-page-event")},function(){if(!Options.isset(Options.HideMessages)){if(Popup.latestId()==-1){Popup.latestId(0)}else{Popup.start()}}});Autosave.assignEvents();if(Account.loggedIn()){Account.info(Account.id(),Account.key(),function(c){Account.bundleLimit(c.syncedLimit);var d=Account.bundleLimit();if(d>10000){$("#upgrade").hide()}})}window.onerror=function(e,c,d){if(!DB.readCookie(b.errorPromptCookie)){Popup.confirm(Messages.ErrorDetectedTitle,Messages.ErrorDetected,function(f){var g=f==="yes"?TBAccessor.getBundleJSONString():"null";Analytics.send(Analytics.JavascriptError,"{0} - {1} - {2}".format(e,c,d),g)});DB.createCookie(b.errorPromptCookie,"1",5)}};Mousetrap.bindGlobal(["! a e"],function(){DB.eraseCookie(b.errorPromptCookie)});Mousetrap.bindGlobal(["! u"],function(){Browser.getCurrentWindow(function(e){var d=Autosave.getBundleName(e.id);if(d){var c=TBAccessor.getLinkList(d).map(function(f){return f.l});Browser.create(c,false,[],function(f){Autosave.addBundle(f.id,d);Browser.closeWindow(e.id);Badge.setWindowBadge(f.id)},{})}})});setTimeout(function(){Options.attachCallback(Options.HideTooltips,function(){if(Tooltip.running){Tooltip.toggle()}else{Tooltip.start()}});if(!Options.isset(Options.HideTooltips)&&Popup.latestId()!==""){Tooltip.start()}},500);var a=$("body");a.find(".image").changeClassOnHover("image","image_on_hover","prevent_change")})();Bundles.fillBundles();Bundles.pull();