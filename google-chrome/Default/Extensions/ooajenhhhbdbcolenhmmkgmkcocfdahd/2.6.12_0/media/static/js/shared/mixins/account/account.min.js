function TBAccount(){this._init("account");this.TB_INFO="tb-info"}TBAccount.inherits(ServerCommunication);TBAccount.method("info",function(c,b,d,a){var e={id:c,key:b};HttpUtils.Post(this._getUrl("info"),e,function(f){d(f.data)},a)});TBAccount.method("signUp",function(a,f,h,i,b,c,g,e){var d=this;$.ajax({crossDomain:true,type:"POST",url:Server.getPath("/signup?referralCode={0}&newInstall={1}".format(b||"None",c?"1":"0")),data:{name:a,email:f,password:h,canContact:i},dataType:"JSON",success:function(j){if(j.status==="Success"){g?g(j):false}else{e?e(j):false}}})});TBAccount.method("login",function(b,a,d,c){var e=this;$.ajax({crossDomain:true,type:"POST",url:Server.getPath("/login"),data:{email:b,password:a},dataType:"JSON",success:function(f){if(f.status==="Success"){DB.insertLocalStorage(e.TB_INFO,JSON.stringify(f.data));d?d(f):false}else{c?c(f):false}}})});TBAccount.method("bundleLimit",function(a){if(!a){var b=this._readInfo("bundleLimit");return b?parseInt(b):3}else{this._setInfo("bundleLimit",a)}});TBAccount.method("key",function(){return this._readInfo("key")});TBAccount.method("id",function(){return this._readInfo("id")});TBAccount.method("username",function(){return this._readInfo("username")});TBAccount.method("upgraded",function(){return this.bundleLimit()>10000&&this.loggedIn()});TBAccount.method("unUpgraded",function(){return this.bundleLimit()<10000&&this.loggedIn()});TBAccount.method("loggedIn",function(){return !!this._readInfo("key")&&!!this._readInfo("id")&&this._readInfo("id").isNumeric()});TBAccount.method("logout",function(a){$.ajax({crossDomain:true,type:"POST",url:Server.getPath("/logout"),dataType:"JSON",success:function(b){a?a():false}});return DB.eraseLocalStorage(this.TB_INFO)});TBAccount.method("_readInfo",function(a){return JSON.parse(DB.readLocalStorage(this.TB_INFO)||"{}")[a]});TBAccount.method("_setInfo",function(a,c){var b=JSON.parse(DB.readLocalStorage(this.TB_INFO));b[a]=c;DB.insertLocalStorage(this.TB_INFO,JSON.stringify(b))});var Account=new TBAccount();