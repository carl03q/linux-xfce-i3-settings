function Accessor(a){this.COOKIE_NAME="tb{0}".format(a||"");this.COOKIE_BUNDLE_INFO="tb-bundle-info";this.COOKIE_HIDDEN="{0}-hidden".format(this.COOKIE_NAME);this.bundleJSON={};this.updated=false}Accessor.method("getLinkList",function(c){var b=this.getBundleJSON();var a=b[c];if(a===undefined){return -1}return a});Accessor.method("getBundleJSON",function(){if(this.updated){return this.bundleJSON}var a=DB.readLocalStorage(this.COOKIE_NAME);if(!a){return{}}this.bundleJSON=JSON.parse(a);this.updated=true;return this.bundleJSON});Accessor.method("getBundleJSONString",function(){return DB.readLocalStorage(this.COOKIE_NAME)});Accessor.method("setBundleJSON",function(a){this.updated=false;DB.insertLocalStorage(this.COOKIE_NAME,a)});Accessor.method("bundleExists",function(b){var a=this.getBundleJSON();return a[b]===undefined?false:true});Accessor.method("getURLList",function(b){var a=this.getLinkList(b),d=[];for(var c=0;c<a.length;c++){d.push(a[c]["l"])}return d});Accessor.method("moveBundle",function(d,c){var a=this.getBundleJSON();var e=Object.keys(a).length;c=c<0?e+c:c;c=c>=e?c%e:c;var b=moveAttribute(a,d,c);this.setBundleJSON(JSON.stringify(b))});Accessor.method("saveBundle",function(d,a){var c=this.getBundleJSON();var b={};b[d]=a;c=collect(c,b);this.setBundleJSON(JSON.stringify(c))});Accessor.method("renameBundle",function(d,b){var c=this.getBundleJSON();var a=c[d];delete (c[d]);c[b]=a;this.setBundleJSON(JSON.stringify(c))});Accessor.method("replaceLinkTitleInBundle",function(d,c,f,g){var b=this.getBundleJSON(),a=this.getLinkList(d);for(var e=0;e<a.length;e++){if(a[e]["l"]===c&&a[e]["t"]===f){a[e]["t"]=g;b[d]=a;this.setBundleJSON(JSON.stringify(b));break}}});Accessor.method("removeLinkFromBundle",function(e,d){var b=this.getBundleJSON(),a=this.getLinkList(e),c=null;for(var f=0;f<a.length;f++){if(a[f]["l"]===d){c=f}}if(c!==null){a.splice(c,1);b[e]=a;this.setBundleJSON(JSON.stringify(b))}});Accessor.method("updateLastOpen",function(a){var b=this._getInfo();b["last-open"]=a;DB.insertLocalStorage(this.COOKIE_BUNDLE_INFO,JSON.stringify(b))});Accessor.method("getLastOpen",function(){return this._getInfo()["last-open"]||""});Accessor.method("_getInfo",function(){return JSON.parse(DB.readLocalStorage(this.COOKIE_BUNDLE_INFO)||"{}")});Accessor.method("removeBundle",function(b){var a=this.getBundleJSON();delete (a[b]);this.unhide(b);this.setBundleJSON(JSON.stringify(a));return 0});Accessor.method("updateBundle",function(c,a){var b=this.getBundleJSON();b[c]=a;this.setBundleJSON(JSON.stringify(b));return 0});Accessor.method("getHidden",function(){return JSON.parse(DB.readLocalStorage(this.COOKIE_HIDDEN)||"{}")});Accessor.method("unhideSynced",function(){var b=this.getHidden();var c={};var a=Object.keys(b);a.map(function(d){if(b[d]===false){c[d]=false}});DB.insertLocalStorage(this.COOKIE_HIDDEN,JSON.stringify(c))});Accessor.method("hide",function(a,c){var b=this.getHidden();var d=[].concat(a);d.map(function(e){b[e]=c||false});DB.insertLocalStorage(this.COOKIE_HIDDEN,JSON.stringify(b))});Accessor.method("unhide",function(a){var b=this.getHidden();if(this.isHidden(a,b)){delete (b[a]);DB.insertLocalStorage(this.COOKIE_HIDDEN,JSON.stringify(b))}});Accessor.method("isHidden",function(a,b){var b=b||this.getHidden();return b[a]!==undefined});var TBAccessor=new Accessor();