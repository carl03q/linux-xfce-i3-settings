function BundleContainer(b,d,c,a){this._init(b,d,c,a)}BundleContainer.method("_init",function(b,e,c,a){var f=".bundle-container";var d=".page-divider";this.id=b;this.$bundle_container=$(b);this.$containers=$(f);this.$divider=$(e);this.$dividers=$(d);this.localEmpty=true;this.syncedEmpty=true;this.keyBinding=a;this.sectionHtml="<ul class='synced-bundle-container sortable-bundle-container'></ul>                       <div class='spacer' hidden></div>                       <ul class='local-bundle-container sortable-bundle-container'></ul>";c?this.$divider.changeClass("image","image_on_hover").addClass("prevent_change"):false;this.bundles=[]});BundleContainer.method("highlightHotkeys",function(){this.bundles.map(function(a){a.highlightHotkey()})});BundleContainer.method("show",function(){this.$dividers.changeClass("image_on_hover","image").removeClass("prevent_change");this.$divider.changeClass("image","image_on_hover").addClass("prevent_change");this.$containers.hide();this.$bundle_container.show()});BundleContainer.method("clear",function(a){this.bundles=[];this.$bundle_container.html(this._emptyHtml())});BundleContainer.method("replace",function(a){this.clear();this.append(a);a.length==0?this._emptyHtml():false});BundleContainer.method("_addBundles",function(b,a){b=isArray(b)?b:[b];if(!this.bundles.length&&b.length){this.$bundle_container.html(this.sectionHtml);this._setupDraggable()}b.map(function(c){!c.hasTabs()?c.fill():false;a?a(c):false;c.assignEvents()})});BundleContainer.method("_handleSpacer",function(b,a){this.syncedEmpty=!(!this.syncedEmpty||b);this.localEmpty=!(!this.localEmpty||a);if(!this.syncedEmpty&&!this.localEmpty){this.$bundle_container.find(".spacer").show()}});BundleContainer.method("_hideSpacer",function(){this.$bundle_container.find(".spacer").hide()});BundleContainer.method("prepend",function(a){var b=this;this._addBundles(a,function(c){b._handleSpacer(true);b.bundles=b._join(c,b.bundles);b.$bundle_container.find(".synced-bundle-container").prepend(c.makeHtml())})});BundleContainer.method("append",function(a){var b=this;this._addBundles(a,function(c){b._handleSpacer(false,true);b.bundles=b._join(b.bundles,c);b.$bundle_container.find(".local-bundle-container").prepend(c.makeHtml())})});BundleContainer.method("start",function(){var a=this;this.$bundle_container.prepend(this._emptyHtml());this.$divider.click(function(){a.show()});Mousetrap.bindGlobal(this.keyBinding,function(){a.$divider.click()});return this});BundleContainer.method("_join",function(b,a){b=!isArray(b)?[b]:b;a=!isArray(a)?[a]:a;return b.concat(a)});BundleContainer.method("_setupDraggable",function(){var d=this;var b=this.$bundle_container.find(".sortable-bundle-container");for(var a=0;a<b.length;a++){var c=$(b[a]);c.sortable({axis:"y",snap:true,start:function(e,f){f.item.find(".edit_highlight").attr("editing")=="true"?f.item.find(".edit").click():false},update:function(f,g){var h=$(this).sortable("toArray",{attribute:"bundleName"});OrderHandler.update(d.id,h);for(var e=0;e<h.length;e++){TBAccessor.moveBundle(h[e],h.length-1-e)}}})}});BundleContainer.method("_emptyHtml",function(){throw"BundleContainer must implement abstract method _emptyHtml."});